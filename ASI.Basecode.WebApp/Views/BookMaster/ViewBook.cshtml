@model ASI.Basecode.WebApp.Models.BookViewModel

@{
    Layout = null;
    var reviews = ViewBag.Reviews as List<ASI.Basecode.WebApp.Models.ReviewModel>;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>@Model.Title - Book Details</title>
    <link rel="stylesheet" href="~/css/style.css" />
    <link rel="stylesheet" href="~/css/admin.css" />
</head>
<body>
    <!-- Admin Navbar -->
    <header class="navbar">
        <div class="logo-group" onclick="location.href='@Url.Action("ListBooks", "BookMaster")'">
            <img src="@Url.Content("~/img/png-logo.png")" class="logo-icon" />
            <h1 class="team-name">Readiculous</h1>
        </div>

        <nav class="nav-links">
            <div class="profile-dropdown" id="profileDropdown">
                <span class="profile-icon" id="profileIcon">👤</span>
                <ul class="dropdown-menu" id="profileMenu">
                    <li><a href="#">User Master</a></li>
                    <li><a href="@Url.Action("ListBooks", "BookMaster")">Genre Master</a></li>
                    <li><a href="#">Book Master</a></li>
                    <li><a href="#">Settings</a></li>
                    <li><a href="@Url.Action("UserView", "UserTest")">Logout</a></li>
                </ul>
            </div>
        </nav>
    </header>
    <!-- Page Title -->
    <div class="page-header">
        <h1 class="page-title">Book Details</h1>
    </div>
    <!-- Book Details Section -->
    <div class="book-details-box">
        <div class="book-details-container">
            <div class="book-details-left">
                <img src="@Url.Content("~/img/Book/" + Model.ImagePath)" alt="@Model.Title Cover" class="book-details-cover" />
            </div>
            <div class="book-info-card">
                <h2 class="book-title">@Model.Title</h2>
                <table class="book-info-table">
                    <tr><th>Author</th><td>@Model.Author</td></tr>
                    <tr><th>Genre</th><td>@Model.Genre</td></tr>
                    <tr><th>Series</th><td>@(string.IsNullOrEmpty(Model.Series) ? "N/A" : Model.Series)</td></tr>
                    <tr>
                        <th>Rating</th>
                        <td>
                            @Model.Rating.ToString("0.0") <span style="color: gold;">&#9733;</span>
                        </td>
                    </tr>
                    <tr><th>Added Date</th><td>@(Model.AddedDate?.ToString("MMMM d, yyyy") ?? "N/A")</td></tr>
                </table>

                <h3>Description</h3>
                <p>@(string.IsNullOrEmpty(Model.Description) ? "No description provided." : Model.Description)</p>
            </div>
        </div>
    </div>
    <!-- Reviews Section -->
    <div class="review-section">
        <div class="review-header">
            <span>Reviews (@(reviews?.Count ?? 0))</span>
        </div>
        @if (reviews?.Count > 0)
        {
            foreach (var review in reviews)
            {
                <div class="review-card">
                    <div class="review-top">
                        <strong>@review.ReviewerName</strong>
                        <span class="review-date">@review.DatePosted.ToString("MMMM d, yyyy")</span>
                    </div>
                    <div class="review-stars">
                        @for (int i = 0; i < review.Rating; i++)
                        {
                            <span style="color: gold;">&#9733;</span>
                        }
                        @for (int i = review.Rating; i < 5; i++)
                        {
                            <span style="color: lightgray;">&#9733;</span>
                        }
                    </div>
                    <p>@review.Comment</p>
                </div>
            }
        }
        else
        {
            <p>No reviews yet. Be the first to leave one!</p>
        }
    </div>
    <script src="~/js/landing.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const profileIcon = document.getElementById("profileIcon");
            const dropdownMenu = document.getElementById("profileMenu");

            profileIcon.addEventListener("click", function (e) {
                e.stopPropagation();
                dropdownMenu.classList.toggle("show");
            });

            document.addEventListener("click", function (e) {
                if (!e.target.closest("#profileDropdown")) {
                    dropdownMenu.classList.remove("show");
                }
            });
        });
    </script>
</body>
</html>
